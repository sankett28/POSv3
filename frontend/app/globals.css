@import "tailwindcss";

/* ============================================================================
   THREE-LAYER THEMING ARCHITECTURE
   ============================================================================
   
   This file implements a strict 3-layer semantic theming system:
   
   LAYER 1: USER THEME TOKENS (Runtime Mutable)
   - Exactly 8 tokens that can be modified at runtime via applyTheme()
   - Stored in database per business
   - These are the ONLY tokens users can edit
   
   LAYER 2: SEMANTIC TOKENS (System Owned - Derived)
   - Provide semantic meaning (text-primary, bg-surface, etc.)
   - Derive from Layer 1 tokens using color-mix()
   - Exposed to Tailwind via @theme inline
   - NOT editable by users
   
   LAYER 3: COMPONENT TOKENS (System Owned - Specific)
   - Component-specific styling tokens
   - Derive from Layer 2 or Layer 1 tokens
   - NOT exposed to Tailwind
   - NOT editable by users
   
   CRITICAL RULES:
   - Only Layer 1 tokens can be modified at runtime
   - Only Layer 2 tokens are exposed to Tailwind
   - All colors must derive from Layer 1 tokens
   - No hardcoded hex values except in Layer 1 defaults
   ========================================================================= */

/* ============================================================================
   LAYER 1: USER THEME TOKENS (Runtime Mutable)
   ============================================================================
   These 8 variables are the ONLY tokens that can be modified at runtime.
   They are set by the applyTheme() function and stored in the database.
   All other colors derive from these tokens.
   ========================================================================= */

:root {
  /* User Theme Tokens - Default Values */
  --theme-primary: #912b48;
  --theme-secondary: #ffffff;
  --theme-background: #fff0f3;
  --theme-foreground: #610027;
  --theme-accent: #b45a69;
  --theme-danger: #ef4444;
  --theme-success: #22c55e;
  --theme-warning: #f59e0b;
  
  /* Radius (preserved from current system) */
  --radius: 0.5rem;
}

/* ============================================================================
   LAYER 2: SEMANTIC TOKENS (System Owned - Derived)
   ============================================================================
   These tokens provide semantic meaning and are derived from Layer 1.
   They are NOT editable by users.
   They ARE exposed to Tailwind via @theme inline.
   ========================================================================= */

:root {
  /* Text Colors - Derive from foreground/background */
  --color-text-primary: var(--theme-foreground);
  --color-text-secondary: color-mix(in srgb, var(--theme-foreground) 70%, transparent);
  --color-text-muted: color-mix(in srgb, var(--theme-foreground) 50%, transparent);
  --color-text-inverse: var(--theme-background);
  
  /* Background Colors - Derive from background/foreground */
  --color-bg-page: var(--theme-background);
  --color-bg-surface: color-mix(in srgb, var(--theme-background) 95%, white);
  --color-bg-elevated: color-mix(in srgb, var(--theme-background) 90%, white);
  --color-bg-overlay: color-mix(in srgb, var(--theme-foreground) 80%, transparent);
  
  /* Border Colors - Derive from foreground */
  --color-border-default: color-mix(in srgb, var(--theme-foreground) 20%, transparent);
  --color-border-subtle: color-mix(in srgb, var(--theme-foreground) 10%, transparent);
  --color-border-emphasis: var(--theme-foreground);
  
  /* Interactive States - Derive from primary/accent/foreground */
  --color-interactive-hover: color-mix(in srgb, var(--theme-primary) 90%, transparent);
  --color-interactive-active: color-mix(in srgb, var(--theme-primary) 80%, black);
  --color-interactive-focus: var(--theme-accent);
  --color-interactive-disabled: color-mix(in srgb, var(--theme-foreground) 30%, transparent);
  
  /* Status Colors - Direct mapping to theme tokens */
  --color-status-success: var(--theme-success);
  --color-status-warning: var(--theme-warning);
  --color-status-error: var(--theme-danger);
  --color-status-info: var(--theme-accent);
  
  /* Backward Compatibility Aliases (temporary during migration) */
  --color-primary: var(--theme-primary);
  --color-secondary: var(--theme-secondary);
  --color-accent: var(--theme-accent);
  
  /* Legacy Brand Tokens (mapped to new system) */
  --brand-deep-burgundy: var(--theme-foreground);
  --brand-dusty-rose: var(--theme-accent);
  --coffee-brown: var(--theme-primary);
  --warm-cream: var(--theme-background);
  --primary-text: var(--color-text-primary);
  --secondary-text: var(--color-text-secondary);
  --muted-text: var(--color-text-muted);
  --border: var(--color-border-default);
  --border-light: var(--color-border-subtle);
  --card-background: var(--color-bg-surface);
}

/* ============================================================================
   LAYER 3: COMPONENT TOKENS (System Owned - Specific)
   ============================================================================
   These tokens are for specific component styling.
   They are NOT editable by users.
   They are NOT exposed to Tailwind.
   ========================================================================= */

:root {
  /* Button Tokens */
  --btn-primary-bg: var(--theme-primary);
  --btn-primary-text: var(--color-text-inverse);
  --btn-primary-border: var(--theme-primary);
  --btn-primary-hover-bg: var(--color-interactive-hover);
  
  --btn-secondary-bg: transparent;
  --btn-secondary-text: var(--color-text-primary);
  --btn-secondary-border: var(--color-border-default);
  --btn-secondary-hover-bg: var(--color-bg-elevated);
  
  /* Input Tokens */
  --input-bg: var(--color-bg-surface);
  --input-text: var(--color-text-primary);
  --input-border: var(--color-border-default);
  --input-placeholder: var(--color-text-muted);
  --input-focus-ring: var(--color-interactive-focus);
  --input-focus-border: var(--theme-primary);
  
  /* Card Tokens */
  --card-bg: var(--color-bg-surface);
  --card-border: var(--color-border-subtle);
  --card-shadow: color-mix(in srgb, var(--theme-foreground) 10%, transparent);
  --card-hover-shadow: color-mix(in srgb, var(--theme-foreground) 20%, transparent);
  
  /* Navigation Tokens */
  --nav-bg: var(--color-bg-elevated);
  --nav-text: var(--color-text-secondary);
  --nav-border: var(--color-border-subtle);
  --nav-active-bg: var(--theme-primary);
  --nav-active-text: var(--color-text-inverse);
  --nav-hover-bg: var(--color-interactive-hover);
}

/* ============================================================================
   TAILWIND EXPOSURE (Layer 2 Only)
   ============================================================================
   Only semantic tokens are exposed to Tailwind utilities.
   This allows components to use: bg-bg-page, text-text-primary, etc.
   ========================================================================= */

@theme inline {
  /* Text Colors */
  --color-text-primary: var(--color-text-primary);
  --color-text-secondary: var(--color-text-secondary);
  --color-text-muted: var(--color-text-muted);
  --color-text-inverse: var(--color-text-inverse);
  
  /* Background Colors */
  --color-bg-page: var(--color-bg-page);
  --color-bg-surface: var(--color-bg-surface);
  --color-bg-elevated: var(--color-bg-elevated);
  --color-bg-overlay: var(--color-bg-overlay);
  
  /* Border Colors */
  --color-border-default: var(--color-border-default);
  --color-border-subtle: var(--color-border-subtle);
  --color-border-emphasis: var(--color-border-emphasis);
  
  /* Interactive States */
  --color-interactive-hover: var(--color-interactive-hover);
  --color-interactive-active: var(--color-interactive-active);
  --color-interactive-focus: var(--color-interactive-focus);
  --color-interactive-disabled: var(--color-interactive-disabled);
  
  /* Status Colors */
  --color-status-success: var(--color-status-success);
  --color-status-warning: var(--color-status-warning);
  --color-status-error: var(--color-status-error);
  --color-status-info: var(--color-status-info);
  
  /* Backward Compatibility (temporary during migration) */
  --color-primary: var(--color-primary);
  --color-secondary: var(--color-secondary);
  --color-accent: var(--color-accent);
  
  /* Legacy Brand Tokens (for existing Tailwind classes) */
  --brand-deep-burgundy: var(--brand-deep-burgundy);
  --brand-dusty-rose: var(--brand-dusty-rose);
  --coffee-brown: var(--coffee-brown);
  --warm-cream: var(--warm-cream);
  --primary-text: var(--primary-text);
  --secondary-text: var(--secondary-text);
  --muted-text: var(--muted-text);
  --border: var(--border);
  --border-light: var(--border-light);
  --card-background: var(--card-background);
  
  /* Direct theme token access (for bg-primary, text-foreground, etc.) */
  --primary: var(--theme-primary);
  --secondary: var(--theme-secondary);
  --foreground: var(--theme-foreground);
  --background: var(--theme-background);
  --accent: var(--theme-accent);
  
  /* Radius */
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
}

/* ============================================================================
   DARK MODE PREPARATION
   ============================================================================
   Structure preserved for future dark mode implementation.
   Currently uses same values as light mode.
   ========================================================================= */

.dark {
  /* Future dark mode overrides will go here */
  /* For now, inherits from :root */
}

/* ============================================================================
   BASE STYLES
   ============================================================================ */

@layer base {
  * {
    @apply border-border-default;
  }
  
  body {
    @apply bg-bg-page text-text-primary;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', sans-serif;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* ============================================================================
   UTILITY STYLES
   ============================================================================
   Animations, focus states, scrollbar, selection, placeholder
   ========================================================================= */

@layer utilities {
  /* Animations */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInLeft {
    from {
      opacity: 0;
      transform: translateX(-24px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(24px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInBottom {
    from {
      opacity: 0;
      transform: translateY(24px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes bounceIn {
    0% {
      opacity: 0;
      transform: scale(0.3);
    }
    50% {
      opacity: 1;
      transform: scale(1.05);
    }
    70% {
      transform: scale(0.9);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(0.5rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-scale-in {
    animation: scaleIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-slide-in-left {
    animation: slideInLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-slide-in-right {
    animation: slideInRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-slide-in-bottom {
    animation: slideInBottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-bounce-in {
    animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .fade-in-up {
    animation: fadeInUp 0.3s ease;
  }

  /* Focus States */
  button:focus-visible,
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    outline: 2px solid var(--theme-primary);
    outline-offset: 2px;
    box-shadow: 0 0 0 3px var(--color-interactive-hover);
  }

  /* Smooth transitions */
  button,
  input,
  select,
  textarea,
  .card-hover {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-bg-surface);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--theme-accent);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--theme-primary);
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--color-interactive-hover);
    border-radius: 10px;
    transition: background 0.2s ease;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--theme-accent);
  }

  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: var(--color-interactive-hover) transparent;
  }

  /* Selection colors */
  ::selection {
    background: var(--color-interactive-hover);
    color: var(--theme-foreground);
  }

  /* Placeholder text */
  ::placeholder {
    color: var(--color-text-muted);
    opacity: 1;
  }
}